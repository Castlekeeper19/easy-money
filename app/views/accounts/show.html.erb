<%= render 'accounts/navbar' %>

<div class="container">
<h1 class ="mt-3"> Account Name: <%= @account.name %> </h1>
<h2> Account Balance:  $<%= @account.account_balance %> </h2>
<p> Account Type: <%= @account.account_type %> </p>



<%= link_to "Add a holding", new_account_holding_path(@account)  %>
<%= link_to "Add a goal", new_account_goal_path(@account)  %>


<table class="table table-striped table-dark">
  <thead class="">
    <tr>
      <th scope="col">*</th>
      <th scope="col">Ticker</th>
      <th scope="col">Stock Price</th>
      <th scope="col">Shares</th>
      <th scope="col">Balance</th>
      <th scope="col">Edit</th>
      <th scope="col">Remove</th>
    </tr>
  </thead>
  <tbody>
    <% @account.stocks.each do |stock| %>
    <tr>
      <th scope="row">*</th>
      <td><%= stock.ticker %></td>
      <td>$<%= stock.stock_price %></td>
      <% stock.holdings.each do |holding| %>
      <td><%= holding.shares %></td>
      <td>$<%= holding.stock_balance %></td>
      <td><%= link_to "Edit", edit_account_holding_path(holding)  %></td>
      <td><%= link_to "Remove", holding_path(holding.id), method: :delete,  data: { confirm: 'Do you want to delete?' }  %></td>
    <% end %>
    </tr>

   <% end %>
  </tbody>
</table>

<h2> ACCOUNT GOALS </h2>
<div class= "cards_goals row">
  <% @account.goals.each do |goal| %>
    <div class ="card_goal col-5">
      <div class="d-flex border-bottom mb-2">
        <div class="goal_img">
          <div class="card_goal_img" style="background-image: linear-gradient(rgba(0,0,0,0.1), rgba(0,0,0,0.1)), url(<%=goal.photo.attached? ? cl_image_path(goal.photo.key) : image_path('https://source.unsplash.com/400x400/?#{goal.name}') %>);">
          </div>
        </div>
        <div class="card_goal_info">
          <p> Name: <%= goal.name%> </p>
          <p> Current: $<%= goal.goal_balance.round(2)%> </p>
          <p> Goal: $<%= goal.goal_amount.round(2)%> </p>
          <p> Complete By: <%= goal.end_date%> </p>
          <p> Completed: <%= goal.completed%> </p>
        </div>
      </div>
        <div class="card_goal_actions d-flex justify-content-around">
         <%= link_to "Edit", edit_account_goal_path(goal), class: "button"  %>
          <%= link_to "Remove", goal_path(goal.id), method: :delete,  data: { confirm: 'Do you want to delete?' }, class: "button"  %>
        </div>
      </div>
    <% end %>
  </div>
</div>
